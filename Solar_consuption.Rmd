---
title: "Solar thermal heat consumption by household"
output: distill::distill_article
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```

I was really curious to see whether countries such as Italy (where I come from) has higher consumption of solar energy. So I started to check which countries in Europe hve the highest consumption of solar thermal heat for household. Solar energy can be a powerful and clean source of electricity and heating for households. From the data I analysed only countries on Southern and Western Europe produce high amounts of solar energy. The leading country in consumption of solar energy is Germany while, in Southern Europe, Greece and Spain are the ones that consume the most.
Surprisingly, countries such as Greece, Spain and Italy, which have more days of sunlight than Western countries, use less solar energy. Italy and France, for instance, have a similar consumption. 

```{r, echo=FALSE, message=FALSE, warning=FALSE, fig.width= 12, fig.height=8}
library(tidyverse)
library(gghighlight)

## remove NA and filter data from 2005 with quantity of Terajoules >= 500
solar_data <- read_csv("data/UNdata_Export_20210712_122757506.csv") %>%
  filter(!is.na(Year))

commodity <- solar_data %>% count(`Commodity - Transaction`)
countries <- solar_data %>% distinct(`Country or Area`)
## Compare southern European countries with northern
southern <- c("Albania", "Croatia", "Greece", "Italy", "Malta", "Portugal", "Slovenia", "Spain")
northern <- c("Denmark", "Finland", "Ireland", "Swden", "United Kingdom")
eastern <- c("Bulgaria", "Czechia", "Hungary", "Poland", "Romania", "Slovakia")
western <- c("Austria", "Belgium", "France", "Germany", "Luxembourg",
             "Netherlands", "Switzerland")

solar_household_Europe <- solar_data %>%
  mutate(Area = case_when(`Country or Area` %in% southern ~ "Southern Europe",
                          `Country or Area` %in% northern ~ "Northern Europe",
                          `Country or Area` %in% eastern ~ "Eastern Europe",
                          `Country or Area` %in% western ~ "Western Europe",
                          TRUE ~ "")) %>%
  filter(`Commodity - Transaction` == "Direct use of solar thermal heat - Consumption by households",
         Area %in% c("Southern Europe", "Northern Europe", "Eastern Europe",
                     "Western Europe"))
## Create line chart:
cbPalette <- c("#999999", "#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00", "#CC79A7")
cbbPalette <- c("#000000", "#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00", "#CC79A7")
solar_household_Europe %>% 
  ggplot(aes(x = Year, y = Quantity, colour = `Country or Area`)) +
  geom_line() + theme_minimal() + 
  gghighlight(max(Quantity) > 2500) +
  ylab("Energy consumption (TJ)") +
  #scale_color_brewer(palette = "Set2") +
  scale_color_manual(values = cbbPalette) +
  facet_wrap(~ Area) +
  theme(axis.title.x = element_text( size=20),
        axis.text.x  = element_text(size=16),
        axis.title.y = element_text( size=20),
        axis.text.y  = element_text(size=16),
        legend.title = element_text(size = 16),
        legend.text = element_text(size = 12)) +
  theme(text = element_text(color = "navy"),
          panel.background = element_rect(fill = "white"),
          panel.grid.major.x = element_blank(),
          panel.grid.minor.x = element_line(color = "grey",
                                            linetype = "dashed"),
          panel.grid.major.y = element_line(color = "grey"),
          panel.grid.minor.y = element_blank(),
          axis.ticks = element_blank(),
          strip.background = element_rect(fill = "white", color = "grey"),
        strip.text = element_text(size = 20)) +
  ggtitle("Direct use of solar thermal heat - Consumption by household from 2000 and 2019") +
  theme(plot.title = element_text(size = 20, face = "bold")) +
  labs(caption = "Source: UNdata")

#ggsave("img/personal/solar.png", dpi = 100)
  
```




